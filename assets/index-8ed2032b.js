import{a as s,j as e,F as N}from"./index-af5071c3.js";import{r as b}from"./vendor-3cc9c64f.js";import{s as T}from"./slugify-733fb410.js";import{T as I,P as k,a as R}from"./PublicTableauInfoFooter-7d99ca21.js";import{B as D}from"./Button-ad7ff481.js";import"./index-503b2546.js";import"./RoutesContent-f2f80844.js";import"./TailwindTypography-878e2c11.js";const v="https://public.tableau.com/views/RegionalSampleWorkbook/Storms",r={ACTIVE:"active",DISABLED:"disabled",PROCESSING:"processing"},U=t=>T(t,{lower:!0,remove:/[*+~.()'"!:@]/g}),B=t=>{const i=t.columns.map(({fieldName:a,dataType:l})=>({fieldId:U(a),fieldName:a,dataType:l}));return t.data.map(a=>i.map((l,u)=>({...l,value:a[u].nativeValue})))},G=()=>{const t=b.useRef(null),[i,c]=b.useState(r.DISABLED),[a,l]=b.useState([]),u=n=>{c(n!==R.READY?r.DISABLED:r.ACTIVE)},x=()=>{l([])},S=async()=>{const n=t.current;if(!n)return;const d=n.workbook.activeSheet;if(d.sheetType!=="dashboard")return;const o=d.worksheets.find(A=>A.name==="Storm Map Sheet");if(!o)return;c(r.PROCESSING);const m=await o.getUnderlyingTablesAsync(),p={maxRows:10,ignoreAliases:!1,ignoreSelection:!0,includeAllColumns:!1},E=await o.getUnderlyingTableDataAsync(m[0].id,p),y=B(E);l(y),setTimeout(()=>{c(r.ACTIVE)},300)},h=i!==r.ACTIVE,w=h||a.length>0,C=h||a.length===0,f=a.length;return s("div",{className:"flex flex-col items-center w-full space-y-3",children:[s("div",{className:"flex gap-3 items-center",children:[e("span",{className:"font-bold",children:"ui status:"}),e("span",{children:i})]}),s("div",{className:"flex space-x-3 items-center",children:[e(D,{disabled:w,onClick:S,children:"Get Data"}),e(D,{disabled:C,onClick:x,children:"Clear Data"})]}),e("div",{className:"flex justify-center h-[650px] min-w-[800px]",children:e(I,{ref:t,viewUrl:v,onStatusChange:u})}),e(k,{tableauUrl:v,label:"Get Data",url:"https://tableau.github.io/embedding-api-v3-samples/getData.html",code:"https://github.com/tableau/embedding-api-v3-samples/blob/main/getData.html"}),f>0?s(N,{children:[e("hr",{className:"border-divider my-4 sm:mx-auto lg:my-6 w-full"}),s("div",{className:"flex space-x-3 items-center font-bold",children:["Data Selected ( ",f," )"]}),s("div",{className:"flex gap-3 items-center justify-center flex-wrap max-h-[30rem] overflow-auto relative",children:[e("div",{className:"sticky top-0 left-0 right-0 h-5 w-full bg-gradient-to-b from-[var(--color-bg-app)] to-transparent"}),a.map((n,d)=>e("div",{className:"p-2 flex flex-col space-y-2 border rounded-md",children:n.map(({fieldId:g,fieldName:o,value:m,dataType:p})=>s("div",{className:"flex gap-3",children:[e("span",{className:"font-bold",children:`${o}:`}),e("span",{children:p==="date-time"?`${new Date(`${m}`).toISOString()}`:`${m}`}),e("span",{children:`( ${p} )`})]},g))},d)),e("div",{className:"sticky bottom-0 left-0 right-0 h-5 w-full bg-gradient-to-b from-transparent to-[var(--color-bg-app)]"})]})]}):null]})},z=G;export{G as PublicGetDataExample,z as default};
