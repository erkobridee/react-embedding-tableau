import{j as e,F as E,a as d,E as b}from"./index-9fd420fd.js";import{r as c,c as M}from"./vendor-50e95b69.js";import{u as O}from"./index-017a603d.js";const P=(t,o)=>{const s=c.useRef(!0);c.useEffect(()=>{s.current?s.current=!1:t()},o)},L={CustomMarkContextMenuEvent:"custommarkcontextmenu",CustomViewLoaded:"customviewloaded",CustomViewRemoved:"customviewremoved",CustomViewSaved:"customviewsaved",CustomViewSetDefault:"customviewsetdefault",EditButtonClicked:"editbuttonclicked",EditInDesktopButtonClicked:"editindesktopbuttonclicked",FilterChanged:"filterchanged",FirstInteractive:"firstinteractive",FirstVizSizeKnown:"firstvizsizeknown",MarkSelectionChanged:"markselectionchanged",ParameterChanged:"parameterchanged",StoryPointSwitched:"storypointswitched",ToolbarStateChanged:"toolbarstatechanged",TabSwitched:"tabswitched",UrlAction:"urlaction",WorkbookPublished:"workbookpublished",WorkbookPublishedAs:"workbookpublishedas",WorkbookReadyToClose:"workbookreadytoclose"},l={IDLE:"idle",LOADING:"loading",READY:"ready",TIMEOUT:"timeout"},w={SET_VIEW_URL:"set-view-url",SET_STATUS:"set-status"},G=(t,o)=>{const{type:s,payload:i}=o;let n=l.IDLE;switch(s){case w.SET_VIEW_URL:return n=l.LOADING,{viewUrl:i,status:n};case w.SET_STATUS:return n=i,{...t,status:n};default:return t}},W=3e3,H=(t,o={})=>{const{initialStatus:s=l.IDLE,statusChangeTimeout:i=W}=o,[n,h]=c.useReducer(G,{viewUrl:t,status:s}),m=a=>{h({type:w.SET_STATUS,payload:a})},T=c.useRef(void 0),v=()=>{const a=T.current;a&&clearTimeout(a)},k=()=>{m(l.TIMEOUT)},u=()=>{v(),T.current=setTimeout(k,i)},g=a=>{u(),h({type:w.SET_VIEW_URL,payload:a})},S=()=>{v(),m(l.READY)};return c.useEffect(()=>{m(l.LOADING);const a=setTimeout(()=>{g(t)},150);return()=>{clearInterval(a)}},[t]),{viewUrl:n.viewUrl,status:n.status,setReady:S}},j=({viewUrl:t,className:o,id:s="tableauViz",instanceIdToClone:i,token:n,toolbar:h,debug:m=!1,hideTabs:T=!1,device:v,filters:k=[],loading:u,onStatusChange:g=()=>{}},S)=>{const{viewUrl:a,status:f,setReady:U}=H(t),I=[`${l.IDLE}`,`${l.LOADING}`].includes(f),p=c.useRef(null);c.useImperativeHandle(S,()=>p.current?p.current:{});const{debug:C,token:D,device:A,toolbar:N,hideTabs:x,loading:_,baseClassName:F}=O(),y=async()=>{setTimeout(()=>{U()},300)};c.useEffect(()=>{const r=p.current;if(r)return r==null||r.addEventListener(L.FirstInteractive,y),()=>{r==null||r.removeEventListener(L.FirstInteractive,y)}},[]),P(()=>{g(f)},[f]);const V=!!(window.matchMedia&&window.matchMedia("(any-pointer:coarse)").matches),R=e("tableau-viz",{ref:p,style:{opacity:I?0:1},src:a,class:M(F,o),id:s,instanceIdToClone:i,device:v||A,toolbar:h||N,token:n||D,debug:m||C?!0:void 0,"hide-tabs":T||x?!0:void 0,"touch-optimize":V?!0:void 0,"data-status":f,children:k.map((r,z)=>e("viz-filter",{...r},z))});return u=u||_,u?d("div",{style:{display:"flex",position:"relative"},children:[e("div",{style:{position:"absolute",top:0,bottom:0,left:0,right:0,opacity:I?1:0},children:u}),R]}):e(E,{children:R})},B=c.forwardRef(j);B.displayName="TableauEmbed";const q=({tableauUrl:t,label:o,url:s,code:i})=>d(E,{children:[d("div",{className:"flex space-x-3",children:[e("div",{className:"font-bold",children:"Public Tableau:"}),e(b,{className:"hover:underline",href:t})]}),d("div",{className:"flex space-x-1",children:[e(b,{className:"hover:underline",href:"https://github.com/tableau",children:"[GitHub] tableau"}),e("span",{children:"/"}),e(b,{className:"hover:underline",href:"https://github.com/tableau/embedding-api-v3-samples",children:"embedding-api-v3-samples"}),s?d(E,{children:[e("span",{children:"/"}),e(b,{className:"hover:underline",href:s,children:o||s}),i?d(E,{children:[e("span",{children:"-"}),e(b,{className:"hover:underline",href:i,children:"code"})]}):null]}):null]})]});export{q as P,B as T,l as a};
