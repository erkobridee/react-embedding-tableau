import{j as s,F as k,a as m,E as p}from"./index-8b97a40a.js";import{r as n,c as $}from"./vendor-8535c4d4.js";import{u as H}from"./index-5958e7ff.js";const A={CustomMarkContextMenuEvent:"custommarkcontextmenu",CustomViewLoaded:"customviewloaded",CustomViewRemoved:"customviewremoved",CustomViewSaved:"customviewsaved",CustomViewSetDefault:"customviewsetdefault",EditButtonClicked:"editbuttonclicked",EditInDesktopButtonClicked:"editindesktopbuttonclicked",FilterChanged:"filterchanged",FirstInteractive:"firstinteractive",FirstVizSizeKnown:"firstvizsizeknown",MarkSelectionChanged:"markselectionchanged",ParameterChanged:"parameterchanged",StoryPointSwitched:"storypointswitched",ToolbarStateChanged:"toolbarstatechanged",TabSwitched:"tabswitched",UrlAction:"urlaction",WorkbookPublished:"workbookpublished",WorkbookPublishedAs:"workbookpublishedas",WorkbookReadyToClose:"workbookreadytoclose"},j=(e,r)=>{const o=n.useRef(!0);n.useEffect(()=>{o.current?o.current=!1:e()},r)},u={IDLE:"idle",LOADING:"loading",READY:"ready",TIMEOUT:"timeout"},S={SET_VIEW_URL:"set-view-url",SET_STATUS:"set-status"},B=(e,r)=>{const{type:o,payload:l}=r;let a=u.IDLE;switch(o){case S.SET_VIEW_URL:return a=u.LOADING,{viewUrl:l,status:a};case S.SET_STATUS:return a=l,{...e,status:a};default:return e}},Y=3e3,K=(e,r={})=>{const{initialStatus:o=u.IDLE,statusChangeTimeout:l=Y}=r,[a,b]=n.useReducer(B,{viewUrl:e,status:o}),c=i=>{b({type:S.SET_STATUS,payload:i})},d=n.useRef(void 0),E=()=>{const i=d.current;i&&clearTimeout(i)},I=()=>{c(u.TIMEOUT)},h=()=>{E(),d.current=setTimeout(I,l)},f=i=>{h(),b({type:S.SET_VIEW_URL,payload:i})},T=()=>{E(),c(u.READY)};return n.useEffect(()=>{c(u.LOADING);const i=setTimeout(()=>{f(e)},150);return()=>{clearInterval(i)}},[e]),{viewUrl:a.viewUrl,status:a.status,setReady:T}},q=({viewUrl:e,className:r,id:o="tableauViz",instanceIdToClone:l,token:a,toolbar:b,debug:c=!1,hideTabs:d=!1,device:E,filters:I=[],loading:h,width:f,height:T,onStatusChange:i=()=>{}},N)=>{const{viewUrl:x,status:w,setReady:z}=K(e),g=[`${u.IDLE}`,`${u.LOADING}`].includes(w),v=n.useRef(null);n.useImperativeHandle(N,()=>v.current?v.current:{});const{debug:V,token:_,device:F,toolbar:M,hideTabs:O,loading:P,baseClassName:G}=H(),R=async()=>{setTimeout(()=>{z()},300)};n.useEffect(()=>{const t=v.current;if(t)return t==null||t.addEventListener(A.FirstInteractive,R),()=>{t==null||t.removeEventListener(A.FirstInteractive,R)}},[]),n.useEffect(()=>{const t=v.current;if(!t||!f&&!T)return;const C=t.shadowRoot.children[0],D=y=>/^\d+$/.test(y)?`${y}px`:y;f&&(C.style.width=D(`${f}`)),T&&(C.style.height=D(`${T}`))},[f,T]),j(()=>{i(w)},[w]);const W=!!(window&&window.matchMedia&&window.matchMedia("(any-pointer:coarse)").matches),L=s("tableau-viz",{ref:v,style:{opacity:g?0:1},src:x,class:$(G,r),id:o,instanceIdToClone:l,device:E||F,toolbar:b||M,token:a||_,debug:c||V?!0:void 0,"hide-tabs":d||O?!0:void 0,"touch-optimize":W?!0:void 0,"data-status":w,children:I.map((t,U)=>s("viz-filter",{...t},U))});return h=h||P,h?m("div",{style:{display:"flex",position:"relative"},children:[s("div",{style:{position:"absolute",top:0,bottom:0,left:0,right:0,opacity:g?1:0},children:h}),L]}):s(k,{children:L})},J=n.forwardRef(q);J.displayName="TableauEmbed";const ee=({tableauUrl:e,githubProfileAccount:r="tableau",githubProfileAccountUrl:o="https://github.com/tableau",githubRepo:l="embedding-api-v3-samples",githubRepoUrl:a="https://github.com/tableau/embedding-api-v3-samples",label:b,url:c,code:d})=>m(k,{children:[m("div",{className:"flex space-x-3",children:[s("div",{className:"font-bold",children:"Public Tableau:"}),s(p,{className:"hover:underline",href:e})]}),m("div",{className:"flex space-x-1",children:[m(p,{className:"hover:underline",href:o,children:["[GitHub] ",r]}),s("span",{children:"/"}),s(p,{className:"hover:underline",href:a,children:l}),c?m(k,{children:[s("span",{children:"/"}),s(p,{className:"hover:underline",href:c,children:b||c}),d?m(k,{children:[s("span",{children:"-"}),s(p,{className:"hover:underline",href:d,children:"code"})]}):null]}):null]})]});export{ee as P,J as T,u as a,A as b,j as u};
